<!DOCTYPE html>
<html>

<head>
    <title>LoveSailing Sailing Photo Search Engine - Regatta sailing Photos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description"
        content="Search, view, and purchase high-quality regatta sailing photos. Find images of sailboats, yacht clubs, sailing events, championships, dinghies, offshore races, and more. The ultimate sailing photo search engine for sailors, photographers, and regatta fans.">
    <meta name="keywords"
        content="sailing photos, regatta images, yacht club photos, sailboat pictures, sailing event photography, championship sailing, dinghy photos, offshore racing, sailing gallery, sailing search engine, buy sailing photos, sailing stock images, LoveSailing, sailing regatta, sailing competition, sailing team, sailing action shots, sailing sports, sailing event images, sailing fleet, sailing race, sailing event pictures, sailing event gallery, sailing event search, sailing event download, sailing event purchase, sailing event prints, sailing event digital, sailing event archive, sailing event collection, sailing event catalog, sailing event database, sailing event marketplace, sailing event store, sailing event shop, sailing event buy, sailing event sell, sailing event license, sailing event stock, sailing event portfolio, sailing event showcase, sailing event exhibition, sailing event display, sailing event view, sailing event preview, sailing event browse, sailing event explore, sailing event discover, sailing event find, sailing event locate, sailing event search engine, regatta, yacht, sailboat, sailing, photos, images, pictures, gallery, event, competition, team, fleet, race, championship, dinghy, offshore, action, sports, club, club photos, club images, club gallery, club event, club regatta, club sailing, club race, club championship, club dinghy, club offshore, club action, club sports, club team, club fleet, club competition, club event, club gallery, club search, club find, club locate, club discover, club explore, club preview, club view, club browse, club buy, club purchase, club download, club prints, club digital, club archive, club collection, club catalog, club database, club marketplace, club store, club shop, club sell, club license, club stock, club portfolio, club showcase, club exhibition, club display, club event, club preview, club browse, club explore, club discover, club find, club locate, club search engine">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="LoveSailing Sailing Photo Search Engine - Regatta sailing Photos">
    <meta property="og:description"
        content="Search, view, and purchase high-quality regatta sailing photos. Find images of sailboats, yacht clubs, sailing events, championships, dinghies, offshore races, and more.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lovesailing.ai/">
    <meta property="og:image" content="https://lovesailing.ai/lovesailing-header.jpg">
    <style>
        /* Reuse the same styles from PhotoUpload.html */
        html,
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .header {
            width: 100%;
            margin: 0 0 30px 0;
            padding: 0;
            position: relative;
            background: #f0f0f0;
        }

        .logo {
            width: 100%;
            height: auto;
            display: block;
            object-fit: cover;
        }

        body {
            font-family: Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .search-section {
            background: #fff;
            border: 3px solid #0066cc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px auto;
            text-align: left;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            max-width: 800px;
        }

        .search-section h2 {
            margin: 0 0 20px 0;
            color: #0066cc;
            text-align: center;
        }

        .search-form-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(auto, 300px));
            gap: 20px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .search-input {
            width: 100%;
            max-width: 250px;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .search-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .search-row {
            margin-bottom: 10px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .search-buttons {
            margin-top: 20px;
            text-align: center;
            grid-column: 1 / -1;
        }

        .search-input:focus {
            border-color: #0066cc;
            outline: none;
        }

        .search-button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            min-width: 120px;
            font-size: 14px;
        }

        .search-button:hover {
            background: #0052a3;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .photo-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            height: 100%;
            cursor: pointer;
            transition: box-shadow 0.2s;
            position: relative;
        }

        .photo-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .photo-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }

        .photo-info {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            display: flex;
            flex-direction: row;
            background: none;
            max-width: 90vw;
            max-height: 90vh;
            margin: auto;
            position: relative;
        }

        .modal-image-container {
            position: relative;
            background: #fff;
            border-radius: 8px 0 0 8px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 300px;
            min-height: 300px;
        }

        .modal-image {
            max-width: 70vw;
            max-height: 80vh;
            display: block;
            border-radius: 8px 0 0 8px;
        }

        .modal-watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 75%;
            height: 75%;
            transform: translate(-50%, -50%);
            opacity: 0.4;
            pointer-events: none;
            background-image: url('watermark.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 2;
        }

        .modal-side-banner {
            display: none !important;
        }

        .purchase-modal-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.2s;
        }

        .purchase-modal-button:hover {
            background: #218838;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #fff;
            font-size: 32px;
            cursor: pointer;
            z-index: 10;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            background: #ffffff;
            border-top: 1px solid #dee2e6;
        }

        .footer img {
            max-height: 100px;
            width: auto;
            margin: 0 auto;
            display: block;
        }

        .clear-button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            min-width: 120px;
            font-size: 14px;
        }

        .clear-button:hover {
            background: #c82333;
        }

        @media (max-width: 768px) {
            .search-form-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .search-input {
                max-width: 100%;
            }

            .search-button,
            .clear-button {
                width: 100%;
                margin: 10px 0;
            }
        }

        @media (max-width: 900px) {
            .modal-content {
                flex-direction: column;
                max-width: 98vw;
            }

            .modal-image-container,
            .modal-image {
                border-radius: 8px 8px 0 0;
                min-width: 200px;
            }

            .modal-side-banner {
                border-radius: 0 0 8px 8px;
                min-width: unset;
                width: 100%;
                padding: 20px 10px;
            }
        }

        .photo-error {
            width: 100%;
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            color: #dc3545;
        }

        .photo-details {
            padding: 10px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .photo-details p {
            margin: 4px 0;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .view-button {
            display: inline-block;
            background: #0066cc;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            margin-top: 8px;
            text-align: center;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
        }

        .view-button:hover {
            background: #0052a3;
        }

        .download-button {
            display: inline-block;
            background: #0066cc;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            margin-top: auto;
            text-align: center;
            transition: background-color 0.2s;
        }

        .download-button:hover {
            background: #0052a3;
        }

        @media (min-width: 1200px) {
            .photo-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            }
        }

        .auth-section {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px auto;
            max-width: 400px;
            text-align: center;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .auth-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .auth-button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        .watermark-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .photo-wrapper:hover .watermark-overlay {
            opacity: 1;
        }

        .remove-watermark-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 14px;
        }

        .remove-watermark-price {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* Add floating purchase button styles */
        .purchase-fab {
            position: absolute;
            bottom: 24px;
            right: 24px;
            background: #28a745;
            color: white;
            border: none;
            padding: 16px 28px;
            border-radius: 32px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.18);
            z-index: 20;
            transition: background 0.2s;
        }

        .purchase-fab:hover {
            background: #218838;
        }

        /* Add thumbnail watermark CSS */
        .thumbnail-watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120%;
            height: 80%;
            transform: translate(-50%, -50%);
            opacity: 0.25;
            pointer-events: none;
            background-image: url('watermark.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 2;
        }
    </style>
    <script src="https://js.stripe.com/v3/"></script>
</head>

<body>
    <div class="header">
        <img src="lovesailing-header.jpg" alt="LoveSailing Header" class="logo">
    </div>

    <div id="authSection" class="auth-section">
        <h3>Sign In</h3>
        <div class="auth-form">
            <input type="email" id="email" placeholder="Email" class="auth-input">
            <input type="password" id="password" placeholder="Password" class="auth-input">
            <button onclick="login()" class="auth-button">Sign In</button>
            <button onclick="showSignup()" class="auth-button" style="background: #6c757d;">Create Account</button>
        </div>
    </div>

    <div class="main-container">
        <div class="search-section">
            <h2>Search Photos</h2>
            <div id="photoCount" style="margin-bottom: 20px; color: #666; font-size: 0.9em; text-align: center;">
                Loading photo count...
            </div>
            <div class="search-form-grid">
                <div class="search-row">
                    <label for="sailNumber" class="search-label">Sail Number</label>
                    <input type="text" id="sailNumber" class="search-input">
                </div>
                <div class="search-row">
                    <label for="date" class="search-label">Date</label>
                    <input type="date" id="date" class="search-input">
                </div>
                <div class="search-row">
                    <label for="regattaName" class="search-label">Regatta Name</label>
                    <input type="text" id="regattaName" class="search-input">
                </div>
                <div class="search-row">
                    <label for="yachtClub" class="search-label">Yacht Club</label>
                    <input type="text" id="yachtClub" class="search-input" list="yachtClubList">
                    <datalist id="yachtClubList">
                        <option value="Alamitos Bay Yacht Club">
                        <option value="American Yacht Club">
                        <option value="Annapolis Yacht Club">
                        <option value="Atlanta Yacht Club">
                        <option value="Austin Yacht Club">
                        <option value="Avalon Yacht Club">
                        <option value="Bay Head Yacht Club">
                        <option value="Beverly Yacht Club">
                        <option value="Chicago Yacht Club">
                        <option value="Corinthian Yacht Club">
                        <option value="Eastern Yacht Club">
                        <option value="Fort Worth Yacht Club">
                        <option value="Houston Yacht Club">
                        <option value="Lake Norman Yacht Club">
                        <option value="Larchmont Yacht Club">
                        <option value="Long Beach Yacht Club">
                        <option value="New York Yacht Club">
                        <option value="Newport Harbor Yacht Club">
                        <option value="San Diego Yacht Club">
                        <option value="San Francisco Yacht Club">
                        <option value="Seattle Yacht Club">
                        <option value="St. Francis Yacht Club">
                    </datalist>
                </div>
                <div class="search-row">
                    <label for="photographerName" class="search-label">Photographer</label>
                    <input type="text" id="photographerName" class="search-input">
                </div>
                <div class="search-row">
                    <label for="location" class="search-label">Location</label>
                    <input type="text" id="location" class="search-input">
                </div>
                <div class="search-buttons">
                    <button class="search-button" onclick="searchPhotos()">Search</button>
                    <button class="clear-button" onclick="clearSearch()">Clear</button>
                </div>
            </div>
        </div>

        <div id="results"></div>
    </div>

    <div id="imageModal" class="modal" tabindex="-1" aria-modal="true" role="dialog">
        <div class="close-button" onclick="closeModal()">&times;</div>
        <div class="modal-content" id="modalContent">
            <div class="modal-image-container" id="modalImageContainer" style="position:relative;">
                <img id="modalImage" class="modal-image" src="" alt="Preview">
                <div class="modal-watermark" id="modalWatermark"></div>
                <button id="purchaseFab" class="purchase-fab" style="display:none;">Purchase Photo</button>
            </div>
        </div>
    </div>

    <div class="footer">
        <a href="https://thomad99.wixstudio.com/lab007" target="_blank">
            <img src="LAB007-FOOTER.JPG" alt="LAB007 Footer">
        </a>
    </div>

    <script>
        let stripe;
        let authToken = localStorage.getItem('authToken');
        let purchasedImages = new Set();

        // Initialize Stripe with config from server
        async function initializeStripe() {
            try {
                const response = await fetch('/api/config');
                const config = await response.json();
                stripe = Stripe(config.stripePublishableKey);
            } catch (err) {
                console.error('Error initializing Stripe:', err);
            }
        }

        // Call this when the page loads
        document.addEventListener('DOMContentLoaded', async () => {
            await initializeStripe();
            updateAuthUI();
            loadPhotoCount();
        });

        // Update the purchaseImage function to ensure Stripe is initialized
        async function purchaseImage(filename) {
            if (!authToken) {
                alert('Please sign in to purchase images');
                return;
            }

            if (!stripe) {
                alert('Payment system is not initialized. Please try again in a moment.');
                return;
            }

            try {
                const response = await fetch('/api/create-payment-session', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ imageFilename: filename })
                });
                const session = await response.json();

                if (session.url) {
                    window.location.href = session.url;
                } else {
                    alert('Error creating payment session');
                }
            } catch (err) {
                console.error('Error processing purchase:', err);
                alert('Error processing purchase');
            }
        }

        async function loadPhotoCount() {
            try {
                const response = await fetch('/api/photo-count');
                const data = await response.json();
                const countDiv = document.getElementById('photoCount');
                countDiv.innerHTML = `Total photos in database: ${data.total}`;
            } catch (err) {
                console.error('Error loading photo count:', err);
                document.getElementById('photoCount').innerHTML = 'Error loading photo count';
            }
        }

        async function searchPhotos() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px;">Searching...</div>';

            const params = new URLSearchParams({
                sail_number: document.getElementById('sailNumber').value,
                date: document.getElementById('date').value,
                regatta_name: document.getElementById('regattaName').value,
                yacht_club: document.getElementById('yachtClub').value,
                photographer_name: document.getElementById('photographerName').value,
                location: document.getElementById('location').value
            });

            try {
                const response = await fetch(`/api/search-photos?${params}`);
                const photos = await response.json();

                if (photos.length === 0) {
                    resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px;">No photos found matching your criteria.</div>';
                    return;
                }

                const matchCount = document.createElement('div');
                matchCount.style.textAlign = 'center';
                matchCount.style.marginBottom = '20px';
                matchCount.style.color = '#666';
                matchCount.innerHTML = `Found ${photos.length} matching photo${photos.length !== 1 ? 's' : ''}`;
                resultsDiv.innerHTML = '';
                resultsDiv.appendChild(matchCount);

                displaySearchResults(photos);
            } catch (err) {
                console.error('Error searching photos:', err);
                resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: red;">Error searching photos. Please try again.</div>';
            }
        }

        function displaySearchResults(photos) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '';

            if (photos.length === 0) {
                resultsContainer.innerHTML = '<p>No photos found matching your criteria.</p>';
                return;
            }

            const grid = document.createElement('div');
            grid.className = 'photo-grid';

            photos.forEach(async photo => {
                const photoCard = document.createElement('div');
                photoCard.className = 'photo-card';
                photoCard.tabIndex = 0;
                photoCard.setAttribute('role', 'button');
                photoCard.setAttribute('aria-label', 'View photo preview');

                // Make the card clickable to open modal
                photoCard.onclick = () => openModal(photo);

                const img = document.createElement('img');
                img.src = photo.url;
                img.alt = `Sail number ${photo.sail_number}`;
                img.loading = 'lazy';
                photoCard.appendChild(img);

                const details = document.createElement('div');
                details.className = 'photo-details';
                details.innerHTML = `
                    <p><strong>Sail Number:</strong> ${photo.sail_number || 'N/A'}</p>
                    <p><strong>Date:</strong> ${photo.date ? new Date(photo.date).toLocaleDateString() : 'N/A'}</p>
                    <p><strong>Regatta:</strong> ${photo.regatta_name || 'N/A'}</p>
                    <p><strong>Photographer:</strong> ${photo.photographer_name || 'N/A'}</p>
                    <p><strong>Location:</strong> ${photo.location || 'N/A'}</p>
                `;
                // Add View Photo button
                const viewBtn = document.createElement('button');
                viewBtn.className = 'view-button';
                viewBtn.textContent = 'View Photo';
                viewBtn.onclick = (e) => {
                    e.stopPropagation();
                    openModal(photo);
                };
                details.appendChild(viewBtn);
                photoCard.appendChild(details);
                grid.appendChild(photoCard);
            });
            resultsContainer.appendChild(grid);
        }

        // Modal logic
        let currentModalPhoto = null;
        async function openModal(photo) {
            currentModalPhoto = photo;
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalWatermark = document.getElementById('modalWatermark');
            const purchaseFab = document.getElementById('purchaseFab');

            modalImg.src = photo.url;
            modalImg.alt = `Sail number ${photo.sail_number}`;

            // Check if purchased
            const isPurchased = await checkImagePurchase(photo.filename);
            if (isPurchased) {
                modalWatermark.style.display = 'none';
                purchaseFab.style.display = 'none';
                // Add or show a Download Photo button
                let downloadBtn = document.getElementById('downloadPhotoBtn');
                if (!downloadBtn) {
                    downloadBtn = document.createElement('a');
                    downloadBtn.id = 'downloadPhotoBtn';
                    downloadBtn.className = 'purchase-fab';
                    downloadBtn.textContent = 'Download Photo';
                    downloadBtn.style.right = '24px';
                    downloadBtn.style.bottom = '24px';
                    downloadBtn.style.position = 'absolute';
                    modalImg.parentNode.appendChild(downloadBtn);
                }
                downloadBtn.href = photo.url;
                downloadBtn.download = photo.filename;
                downloadBtn.style.display = 'block';
            } else {
                modalWatermark.style.display = '';
                purchaseFab.style.display = 'block';
                purchaseFab.onclick = function () { purchaseImage(photo.filename); };
                // Hide Download Photo button if present
                const downloadBtn = document.getElementById('downloadPhotoBtn');
                if (downloadBtn) downloadBtn.style.display = 'none';
            }
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.getElementById('purchaseFab').style.display = 'none';
            const downloadBtn = document.getElementById('downloadPhotoBtn');
            if (downloadBtn) downloadBtn.style.display = 'none';
            currentModalPhoto = null;
        }

        function clearSearch() {
            // Clear all input fields
            document.getElementById('sailNumber').value = '';
            document.getElementById('date').value = '';
            document.getElementById('regattaName').value = '';
            document.getElementById('yachtClub').value = '';
            document.getElementById('photographerName').value = '';
            document.getElementById('location').value = '';

            // Clear the results
            document.getElementById('results').innerHTML = '';
        }

        async function checkImagePurchase(filename) {
            if (!authToken) return false;

            try {
                const response = await fetch(`/api/check-image-purchase/${encodeURIComponent(filename)}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                const data = await response.json();
                return data.isPurchased;
            } catch (err) {
                console.error('Error checking image purchase:', err);
                return false;
            }
        }

        async function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();
                if (data.token) {
                    authToken = data.token;
                    localStorage.setItem('authToken', authToken);
                    await updateAuthUI();
                } else {
                    alert('Invalid credentials');
                }
            } catch (err) {
                alert('Error logging in');
            }
        }

        async function register() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();
                if (data.token) {
                    authToken = data.token;
                    localStorage.setItem('authToken', authToken);
                    await updateAuthUI();
                } else {
                    alert('Error creating account');
                }
            } catch (err) {
                alert('Error registering');
            }
        }

        function showSignup() {
            const authSection = document.getElementById('authSection');
            authSection.innerHTML = `
                <h3>Create Account</h3>
                <div class="auth-form">
                    <input type="email" id="email" placeholder="Email" class="auth-input">
                    <input type="password" id="password" placeholder="Password" class="auth-input">
                    <button onclick="register()" class="auth-button">Create Account</button>
                    <button onclick="showLogin()" class="auth-button" style="background: #6c757d;">Back to Sign In</button>
                </div>
            `;
        }

        function showLogin() {
            const authSection = document.getElementById('authSection');
            authSection.innerHTML = `
                <h3>Sign In</h3>
                <div class="auth-form">
                    <input type="email" id="email" placeholder="Email" class="auth-input">
                    <input type="password" id="password" placeholder="Password" class="auth-input">
                    <button onclick="login()" class="auth-button">Sign In</button>
                    <button onclick="showSignup()" class="auth-button" style="background: #6c757d;">Create Account</button>
                </div>
            `;
        }

        async function updateAuthUI() {
            const authSection = document.getElementById('authSection');

            if (authToken) {
                authSection.style.display = 'none';
            } else {
                authSection.style.display = 'block';
            }
        }

        // Add URL parameter handling for successful payments
        window.addEventListener('load', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const sessionId = urlParams.get('session_id');
            const imageFilename = urlParams.get('image');

            if (sessionId && imageFilename) {
                alert('Payment successful! The watermark has been removed from your image.');
                // Refresh the search results to show the updated image
                searchPhotos();
            }
        });
    </script>
</body>

</html>